/*! YAMVC v0.1.4 - 2013-12-17 
 *  License:  */
(function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.set("set",[]),i.set("cache",[]),i.initConfig()},e.prototype.initConfig=function(){if(n.Core.prototype.initConfig.apply(this),!config.model)throw Error("Set model type for collection");if(!config.model instanceof n.Model)throw Error("Set proper model type for collection")},e.prototype.load=function(t){var e,n,i=this,r=(i.get("data"),i.get("idProperty"),0);for(n in t)r++;if(0===r)throw Error("You need to pass at least one condition to load model collection");e=function(){"success"===i.getProxy().getStatus()?(i.set("isDirty",!1),i.prepareData(),i.fireEvent("loaded",i,i.getProxy().getResponse(),"read")):i.fireEvent("error",i,"read")},i.getProxy().read(i.getNamespace(),t,e)},e.prototype.prepareData=function(){for(var t=this,e=t.getModel(),n=t.getProxy().getResult(),i=n.rows,r=[],o=0,s=i.length;s>o;o++)r.push(new e({data:i[o]}));t.set("set",r),t.set("total",n.total)},t.yamvc=n,t.yamvc.Collection=e})(window),function(t){"use strict";var e,n,i=t.yamvc||{};e=i.Core.extend(function(){i.Core.apply(this,arguments)}),e.prototype.init=function(t){var e,r=this;return t=t||{},e=t.config||{},n=n||new i.Router,r.set("initOpts",t),r.set("config",e),r.set("routes",e.routes||{}),r.set("events",e.events||{}),r.set("views",e.views||{}),r.initConfig(),r.renderViews(),r.restoreRouter(),r},e.prototype.initConfig=function(){i.Core.prototype.initConfig.apply(this);var t,e,r=this,o=r.get("routes"),s=r.get("events"),a=r.get("views"),p=/(^\$|,$)/;if(o)for(var c in o)if(o.hasOwnProperty(c)){var u=r[o[c]].bind(r);n.when(c,u)}if(s&&a){for(e in a)a.hasOwnProperty(e)&&a[e].addListener("render",r.resolveEvents.bind(r));for(t in s)if(s.hasOwnProperty(t)&&p.test(t)){if(e=a[t.substr(1)])for(var f in s[t])s[t].hasOwnProperty(f)&&e.addListener(f,s[t][f].bind(r,e));delete s[t]}}return this},e.prototype.renderViews=function(){var t=this,e=t.get("views");for(var n in e)e.hasOwnProperty(n)&&e[n].getAutoCreate&&e[n].getAutoCreate()&&e[n].render()},e.prototype.resolveEvents=function(t){var e,n,i=this.get("events");for(var r in i)if(i.hasOwnProperty(r)){e=i[r];for(var o=t.get("el").querySelectorAll(r),s=0,a=o.length;a>s;s++)for(var p in e)e.hasOwnProperty(p)&&(n=function(t,e,n){return t.bind(e,n)}(e[p],this,t),o[s].addEventListener(p,n))}},e.prototype.getRouter=function(){return n},e.prototype.restoreRouter=function(){var t=this;return t.getRouter().restore(),t},e.prototype.redirectTo=function(e){return t.location.hash=e,this},t.yamvc.Controller=e}(window),function(t){"use strict";function e(){for(var t=0,e=o.length;e>t;t++)o[t]()}var n,i,r=t.yamvc||{},o=[];r.onReady=function(t){o.push(t),i||"complete"===document.readyState||(i=setInterval(function(){"complete"===document.readyState&&(clearInterval(i),e())},10))},n=r.Core||function(){function t(){this.set("listeners",{}),this.bindMethods.apply(this,arguments),this.init.apply(this,arguments)}return t.prototype.init=function(){},t.prototype.initConfig=function(){var t,e,n,i=this,r=i.get("config"),o=function(n){t="get"+n.charAt(0).toUpperCase()+n.slice(1),e="set"+n.charAt(0).toUpperCase()+n.slice(1),i[t]=function(){return i.get("config")[n]},i[e]=function(t,e){var n=i.get("config")[t];e!==n&&(i.get("config")[t]=e,i.fireEvent(t+"Change",this,e,n))}};for(n in r)r.hasOwnProperty(n)&&o(n)},t.prototype.bindMethods=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(this[e]=t[e].bind(this))},t.prototype.onChange=function(t,e){return this.addListener(t+"Change",e),this},t.prototype.unbindOnChange=function(t,e){for(var n=this._listeners[t+"Change"]||[],i=0,r=n.length;r>i;i++)n[i]===e&&n.splice(i,1);return this._listeners[t+"Change"]=n,this},t.mixin=function(t,e){var n,i;e?n="function"==typeof t?t.prototype:t:(e="function"==typeof t?t.prototype:t,n=this.prototype);for(i in e)"init"!==i?e.hasOwnProperty(i)&&(n[i]=e[i]):"function"==typeof this&&this._mixins.push(e.init)},t._mixins=[],t.extend=function(e){var n,i=this,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};return n=function(t){return o(e,t),e}(i),n.extend=t.extend,n.mixin=t.mixin,n._mixins=[],n},t.mixin(r.mixins.GetSet),t.mixin(r.mixins.Observable),t}(),r.Core=n,t.yamvc=r}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig()},e.prototype.initConfig=function(){var t=this;n.Core.prototype.initConfig.apply(this),t.set("lastResponse",{})},e.prototype.read=function(){},e.prototype.create=function(){},e.prototype.update=function(){},e.prototype.destroy=function(){},e.prototype.update=function(){},e.prototype.getResult=function(){var t=this;return t.get("lastResponse")},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.Proxy=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig()},e.prototype.initConfig=function(){n.Core.prototype.initConfig.apply(this)},e.prototype.read=function(){var t,e=localStorage[model.getNamespace()]||{};for(t in e)e.hasOwnProperty(t)&&(model[t]=e[t])},e.prototype.create=function(){var t,e;localStorage[e.getNamespace()]={};for(t in e)e.hasOwnProperty(t)&&"function"!=typeof e[t]&&(localStorage[e.getNamespace()][t]=e[t])},e.prototype.update=function(){},e.prototype.destroy=function(){delete localStorage[model.getNamespace()]},e.prototype.update=function(){},t.yamvc=n,t.yamvc.data=t.yamvc.data||{},t.yamvc.data.proxy=t.yamvc.data.proxy||{},t.yamvc.data.proxy.Localstorage=e}(window),function(t){"use strict";var e,n=t.yamvc||{},i=n.mixins||{};e={set:function(t,e){var n="_"+t,i=this[n];return e!==i&&(this[n]=e,this.fireEvent(t+"Change",this,e,i)),this},get:function(t){return this["_"+t]}},i.GetSet=e,t.yamvc=n,t.yamvc.mixins=i}(window),function(t){"use strict";var e,n=t.yamvc||{},i=n.mixins||{};e={init:function(){this.set("listeners",{}),this.set("suspendEvents",!1)},fireEvent:function(t){if(this._suspendEvents)return!0;var e=!0,n=Array.prototype.shift;n.call(arguments);for(var i=0,r=this._listeners[t]||[],o=r.length;o>i;i++)if(e){var s=n.call(arguments);e=r[i].apply(s,arguments),e=e===undefined?!0:e}return e},addListener:function(t,e){var n=this._listeners[t]||[];return n.push(e),this._listeners[t]=n,this},removeListener:function(t,e){var n,i=this._listeners;if(i)if(e){if("function"==typeof e)for(var r=0,o=i.length;o>r;r++)i[r]===e&&(n=r);else n=e;i.splice(n,1)}else this._listeners=[];return this},suspendEvents:function(t){return t=t||!0,this.set("suspendEvents",t),this}},i.Observable=e,t.yamvc=n,t.yamvc.mixins=i}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this,arguments)}),e.prototype.init=function(t){n.Core.prototype.init.apply(this,arguments);var e,i=this;t=t||{},e=t.config||{},i.set("initOpts",t),i.set("config",e),i.initConfig(),i.initData()},e.prototype.initConfig=function(){var t=this,e=t.get("config");if(n.Core.prototype.initConfig.apply(this),!e.namespace)throw Error("Model need to have namespace property in your model configuration");return this},e.prototype.initData=function(){var t=this,e=t.get("initOpts"),n=t.get("config");t.set("data",e.data||{}),t.set("idProperty",n.idProperty||"id")},e.prototype.$set=function(t,e){var n=this,i=n.get("data"),r=i[t];e!==r&&(i[t]=e,n.set("isDirty",!0),n.fireEvent("data"+t.charAt(0).toUpperCase()+t.slice(1)+"Change",n,e,r))},e.prototype.$get=function(t){var e=this;return e.get("data")[t]},e.prototype.setData=function(t){var e,n=this,i=n.get("data");for(e in t)t.hasOwnProperty(e)&&n.$set(e,t[e]);n.fireEvent("dataChange",n,i)},e.prototype.load=function(t){var e,n,i=this,r=i.get("data"),o=i.get("idProperty"),s=0;for(n in t)s++;if(0===s&&r[o]===undefined)throw Error("You need to pass at least one condition to load model");0===s&&(t[o]=r[o]),e=function(){"success"===i.getProxy().getStatus()?(i.set("isDirty",!1),i.set("data",i.getProxy().getResponse()),i.fireEvent("loaded",i,i.getProxy().getResponse(),"read")):i.fireEvent("error",i,"read")},i.getProxy().read(i.getNamespace(),t,e)},e.prototype.save=function(){var t,e,n=this,i=n.get("data"),r=n.get("idProperty");return n.get("isProcessing")?!1:(n.set("isProcessing",!0),t=function(){n.set("isProcessing",!1),"success"===n.getProxy().getStatus()?(n.set("isDirty",!1),n.set("data",n.getProxy().getResponse()),n.fireEvent("saved",n,n.getProxy().getResponse(),e)):n.fireEvent("error",n,e)},i[r]===undefined?(e="create",n.getProxy().create(n.getNamespace(),i,t)):(e="update",n.getProxy().update(n.getNamespace(),i,t)),!0)},e.prototype.remove=function(){var t,e=this,n=e.get("data"),i=e.get("idProperty");if(n[i]===undefined)throw Error("Can not remove empty model");t=function(){"success"===e.getProxy().getStatus()?(delete n[i],e.set("isDirty",!1),e.set("data",{}),e.fireEvent("removed",e,"destroy")):e.fireEvent("error",e,"destroy")},e.getProxy().destroy(e.getNamespace(),n,t)},t.yamvc=n,t.yamvc.Model=e}(window),function(t){"use strict";var e,n=t.yamvc||{};e=n.Core.extend(function(){n.Core.apply(this)}),e.prototype.init=function(){this.set("routing",{}),this.bindEvents()},e.prototype.bindEvents=function(){return t.onhashchange=this.onHashChange.bind(this),this},e.prototype.onHashChange=function(){var e=this.get("routing"),n=t.location.hash.substr(1),i=n.split("/"),r=i.shift();if(e[r]){var o=[];if(e[r].params)for(var s=0,a=e[r].params.length;a>s;s++){var p=e[r].params[s],c=i[s],u=RegExp(p.substr(1,p.length-2));o.push(c.match(u).input)}e[r].callback.apply(null,o)}return this},e.prototype.restore=function(){return this.onHashChange(),this},e.prototype.when=function(t,e){var n=this.get("routing"),i=t.split("/"),r=i.shift();return n[r]={callback:e,params:i},this.set("routing",n),this},t.yamvc.Router=e}(window),function(t){"use strict";var e,n,i,r=t.yamvc||{};e={views:{},i:0,add:function(t,e){this.views[t]=e,this.i++},get:function(t){return this.views[t]}},n={tpl:{},add:function(t,e){this.tpl[t]=e},get:function(t){return this.tpl[t]}},i=r.Core.extend(function(){r.Core.apply(this,arguments)}),i.prototype.init=function(t){r.Core.prototype.init.apply(this);var n,i,o=this;t=t||{},n=t.config||{},n.id=i=n.id||"view-"+e.i,n.views=n.views||{},o.set("initOpts",t),o.set("config",n),o.initConfig(),e.add(i,o)},i.prototype.initConfig=function(){r.Core.prototype.initConfig.apply(this),this.initTemplate(),this.initModels()},i.prototype.initTemplate=function(){var t,e=this,i=e.get("config"),r=document.createElement("div");if(!i.tpl)throw Error(i.id+": no tpl set");if(!n.get(i.tpl)){if(t=document.getElementById(i.tpl),!t)throw Error("no tpl "+i.tpl+" found");n.add(i.tpl,t.parentNode.removeChild(t))}r.innerHTML=n.get(i.tpl).innerHTML,e.set("tpl",r)},i.prototype.initModels=function(){var t,e,n=this;if(!n.getModels)return n;t=n.getModels();for(e in t)t.hasOwnProperty(e)&&n.setModel(e,t[e]);return n},i.prototype.setModel=function(t,e){var n=this,i=n.getModels();return i[e.getNamespace()]=e,n.setModels(i),n},i.prototype.getModel=function(t){var e=this,n=e.getModels();return n[t]},i.prototype.render=function(t){var e,n,i,r=this,o=r.get("tpl"),s=document.createElement("div"),a=r.get("config"),p=a.renderTo,c=t||a.models,u=a.parent,f=a.parent;if(u?u=p&&u.queryEl(p)?u.queryEl(p):u.get("el"):p&&(u=document.querySelector(p)),i=o.innerHTML,c&&(n=i.match(/\{\{(.*?)\}\}/gi)))for(var d=0,l=n.length;l>d;d++){var y=n[d],g=y.substr(2,y.length-4).split(".");i=c[g[0]]!==undefined&&"function"!=typeof c[g[0]]?i.replace(y,c[g[0]].$get(g[1])):i.replace(y,"")}s.innerHTML=i;for(var h=0;o.childNodes.length>h&&1!==o.childNodes.item(h).nodeType;)h++;return e=s.childNodes.item(h),e.setAttribute("yamvc-id",a.id),r.set("el",e),u&&(u.appendChild(e),f&&(f.views=f.views||{},f.views[a.id]=r),r.set("isInDOM",!0),r.reAppendChildren(),r.fireEvent("render",null,r)),e},i.prototype.partialRender=function(t){var e,n=this,i=n.get("tpl"),r=i.querySelector(t),o=n.queryEl(t),s=r.innerHTML,a=n.getModels();if(e=s.match(/\{\{(.*?)\}\}/gi))for(var p=0,c=e.length;c>p;p++){var u=e[p],f=u.substr(2,u.length-4).split(".");s=a[f[0]]!==undefined&&"function"!=typeof a[f[0]]?s.replace(u,a[f[0]].$get(f[1])):s.replace(u,"")}return o.innerHTML=s,n.fireEvent("partialRender",null,n,o),n},i.prototype.queryEl=function(t){return this.get("el").querySelector(t)},i.prototype.queryEls=function(t){return this.get("el").querySelectorAll(t)},i.prototype.getChild=function(t){var e=this,n=e.get("config");return n.views&&!n.views[t]||!n.view?!1:n.views[t]},i.prototype.addChild=function(t,e){var n=this;return t.appendTo(n,e),n.fireEvent("elementAdded",n,t),n},i.prototype.removeChildren=function(){for(var t=this.get("config").views||[],e=0,n=t.length;n>e;e++)t[e].clear()},i.prototype.clear=function(){var t=this,e=t.get("el");return t.isInDOM()&&(e.parentNode.removeChild(e),t.set("isInDOM",!1)),t},i.prototype.isInDOM=function(){return this._isInDOM},i.prototype.appendTo=function(t,e){var n=this,i=n.get("config"),r=i.id,o=t.get("config").views,s=e?t.get("el").querySelector(e):t.get("el");return e&&(i.renderTo=e),i.parent?i.parent&&i.parent.get("config").id!==t.get("config").id&&delete i.parent.get("config").views[r]:i.parent=t,!n.isInDOM()&&t.isInDOM()&&(n.get("el")?(s.appendChild(n.get("el")),n.set("isInDOM",!0),n.reAppendChildren(),n.fireEvent("render",null,n)):n.render()),o[r]=n,i.parent=t,n},i.prototype.reAppendChildren=function(){var t=this.get("config").views;for(var e in t)t.hasOwnProperty(e)&&t[e].appendTo(this)},i.prototype.show=function(){var t,e=this;return e.isInDOM()?(t=e.get("el").style,t.display="block",e.set("visible",!0),e.fireEvent("show",e,t),e):e},i.prototype.hide=function(){var t,e=this;return e.isInDOM()?(t=e.get("el").style,t.display="none",e.set("visible",!1),e.fireEvent("hide",e,t),e):e},i.prototype.isVisible=function(){var t=this;return t.get("visible")&&t.isInDOM()},r.ViewManager=e,t.yamvc=r,t.yamvc.View=i}(window);
//@ sourceMappingURL=YAMVC-v0.1.4.min.js.map