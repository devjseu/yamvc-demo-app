/*! culturalMe v1.0.0 - 2013-12-17 
 *  License:  */
// Generated by CoffeeScript 1.6.3
(function() {
  var Db, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.data = app.data || {};

  yamvc = window.yamvc;

  Db = yamvc.Core.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Core.apply(this, all);
    return this;
  });

  Db.prototype.init = function() {
    var all, config, opts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Core.prototype.init.apply(this, all);
    opts = all[0] || {};
    config = opts.config || {};
    this.set('initOpts', opts);
    this.set('config', config);
    this.initConfig();
    if (!this.getName) {
      throw new Error('Database name should be set');
    }
  };

  Db.prototype.connect = function() {
    if (!this.get('connect')) {
      this.set('connect', new ydn.db.Storage(this.getName(), this.getSchema()));
    }
    return this;
  };

  Db.prototype.close = function() {
    this.getConnection().close();
    this.set('connect', null);
    return this;
  };

  Db.prototype.getConnection = function() {
    if (!this.get('connect')) {
      this.connect();
    }
    return this.get('connect');
  };

  Db.prototype.clear = function() {
    return this.getConnection().clear();
  };

  app.data.Db = Db;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Db.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var YdnDb, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.data = app.data || {};

  app.data.proxy = app.data.proxy || {};

  yamvc = window.yamvc;

  YdnDb = yamvc.Core.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Core.apply(this, all);
    return this;
  });

  YdnDb.prototype.init = function() {
    var all, config, opts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    opts = all[0] || {};
    config = opts.config || {};
    config.idProperty = 'id';
    this.set('initOpts', opts);
    this.set('config', config);
    this.initConfig();
    return this;
  };

  YdnDb.prototype.getStatus = function() {
    return this.get('status');
  };

  YdnDb.prototype.getResponse = function() {
    return this.get('response');
  };

  YdnDb.prototype.read = function(namespace, data, callback) {
    var $set, idProperty, req;
    idProperty = this.getIdProperty();
    if (typeof data[idProperty] === 'object') {
      console.log(idProperty);
    }
    $set = this.set.bind(this);
    req = this.getDb().getConnection().get(namespace, data[idProperty]);
    req.done(function(key) {
      $set('status', 'success');
      data[idProperty] = key;
      $set('response', data);
      return callback();
    });
    req.fail(function(e) {
      $set('status', 'error');
      $set('response', e);
      return callback();
    });
    return this;
  };

  YdnDb.prototype.create = function(namespace, data, callback) {
    var $set, idProperty, req;
    $set = this.set.bind(this);
    idProperty = this.getIdProperty();
    req = this.getDb().getConnection().put({
      name: namespace,
      keyPath: idProperty
    }, data);
    req.done(function(key) {
      $set('status', 'success');
      data[idProperty] = key;
      $set('response', data);
      return callback();
    });
    req.fail(function(e) {
      $set('status', 'error');
      $set('response', e);
      return callback();
    });
    return this;
  };

  YdnDb.prototype.update = function(namespace, data, callback) {
    var $set, req;
    $set = this.set.bind(this);
    req = this.getDb().getConnection().put(namespace, data);
    req.done(function() {
      $set('status', 'success');
      $set('response', data);
      return callback();
    });
    req.fail(function(e) {
      $set('status', 'error');
      $set('response', e);
      return callback();
    });
    return this;
  };

  YdnDb.prototype.destroy = function(namespace, data, callback) {
    var $set, idProperty, req;
    idProperty = this.getIdProperty();
    if (typeof data[idProperty] === 'object') {
      console.log(idProperty);
    }
    $set = this.set.bind(this);
    req = this.getDb().getConnection().remove(namespace, data[idProperty]);
    req.done(function() {
      $set('status', 'success');
      $set('response', {});
      return callback();
    });
    req.fail(function(e) {
      $set('status', 'error');
      $set('response', e);
      return callback();
    });
    return this;
  };

  app.data.proxy.YdnDb = YdnDb;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=ydnDb.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var DateHelper, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.logic = app.logic || {};

  yamvc = window.yamvc;

  DateHelper = yamvc.Core.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Core.apply(this, all);
    return this;
  });

  DateHelper.prototype.daysInMonth = function(month, year) {
    return new Date(year, month, 0).getDate();
  };

  DateHelper.prototype.daysAgo = function(from, days) {
    return new Date(+new Date(from) - days * 24 * 60 * 60 * 1000);
  };

  DateHelper.prototype.parse = function(str) {
    var d, m, matchesNonPadded, matchesPadded, pad;
    pad = function(x) {
      var _ref;
      return ((_ref = ('' + x).length === 2) != null ? _ref : {
        '': '0'
      }) + x;
    };
    m = str.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
    d = m ? new Date(m[3], m[2] - 1, m[1]) : null;
    matchesPadded = d && (str === [pad(d.getDate()), pad(d.getMonth() + 1), d.getFullYear()].join('/'));
    matchesNonPadded = d && (str === [d.getDate(), d.getMonth() + 1, d.getFullYear()].join('/'));
    if (matchesPadded || matchesNonPadded) {
      return d;
    } else {
      return null;
    }
  };

  app.logic.Date = new DateHelper;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Date.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var app, yamvc;

  app = window.app || {};

  yamvc = window.yamvc;

  app.init = function() {
    app.data.db = new app.data.Db({
      config: {
        name: 'culturalMe',
        schema: {
          stores: [
            {
              name: 'incomes',
              keyPath: 'id',
              autoIncrement: true,
              indexes: [
                {
                  keyPath: 'date'
                }
              ]
            }, {
              name: 'expenses',
              keyPath: 'id',
              autoIncrement: true,
              indexes: [
                {
                  keyPath: 'date'
                }
              ]
            }
          ]
        }
      }
    });
    app.layout = new app.views.Layout({
      config: {
        autoCreate: true,
        tpl: 'tpl-layout',
        renderTo: '#container'
      }
    });
    app.income = new app.views.window.AddIncome({
      config: {
        autoCreate: true,
        id: 'add-income',
        tpl: 'tpl-window',
        renderTo: 'body'
      }
    });
    app.income.render();
    app.expense = new app.views.window.AddExpense({
      config: {
        autoCreate: true,
        id: 'add-expense',
        tpl: 'tpl-window',
        renderTo: 'body'
      }
    });
    app.expense.render();
    app.controlles = {
      main: new yamvc.Controller({
        config: {
          name: 'Main',
          views: {
            layout: app.layout
          },
          events: {
            $layout: {
              render: function() {
                app.models.balance.load();
                return setTimeout(function() {
                  return app.mask.hide();
                }, 500);
              }
            },
            '.add-expense a': {
              click: function(view, e) {
                e.preventDefault();
                return this.onExpenseBtnClick();
              }
            },
            '.add-income a': {
              click: function(view, e) {
                e.preventDefault();
                return this.onIncomeBtnClick();
              }
            },
            '[yamvc-id="list-incomes"] a': {
              click: function(view, e) {
                e.preventDefault();
                return this.onListIncomesBtnClick();
              }
            },
            '[yamvc-id="list-expenses"] a': {
              click: function(view, e) {
                e.preventDefault();
                return this.onListExpensesBtnClick();
              }
            }
          }
        },
        onExpenseBtnClick: function() {
          return yamvc.ViewManager.get('add-expense').show();
        },
        onIncomeBtnClick: function() {
          return yamvc.ViewManager.get('add-income').show();
        },
        onListIncomesBtnClick: function() {
          return console.log('list incomes click');
        },
        onListExpensesBtnClick: function() {
          return console.log('list expenses click');
        }
      })
    };
    return this;
  };

  window.app = app;

  yamvc.onReady(app.init);

}).call(this);

/*
//@ sourceMappingURL=main.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Balance, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.models = app.models || {};

  yamvc = window.yamvc;

  Balance = yamvc.Model.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Model.apply(this, all);
    return this;
  });

  Balance.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return yamvc.Model.prototype.init.apply(this, all);
  };

  Balance.prototype.initConfig = function() {
    var all, config, currentDate, initOpts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    initOpts = this.get('initOpts');
    initOpts.data = {
      resources: 0,
      expenses: 0,
      available: 0
    };
    currentDate = new Date();
    this.set('from', 1 + '/' + (currentDate.getMonth() + 1) + '/' + currentDate.getFullYear());
    this.set('to', currentDate.getDate() + '/' + (currentDate.getMonth() + 1) + '/' + currentDate.getFullYear());
    config.namespace = 'balance';
    this.set('initOpts', initOpts);
    return yamvc.Model.prototype.initConfig.apply(this, all);
  };

  Balance.prototype.setRange = function(from, to) {
    this.set('from', from);
    return this.set('to', to);
  };

  Balance.prototype.load = function() {
    this.set('toLoad', 2);
    this.loadResources();
    this.loadExpenses();
    return this;
  };

  Balance.prototype.loadResources = function() {
    var db, from, me, q, resources, to;
    me = this;
    resources = 0;
    from = new Date(app.logic.Date.parse(this.get('from')));
    to = new Date(app.logic.Date.parse(this.get('to')));
    db = app.data.db.getConnection();
    q = db.from('incomes');
    return q.where('date', '>=', from.getTime(), '<', to.getTime() + 24 * 60 * 60 * 1000).list().done(function(records) {
      var i, l;
      i = 0;
      l = records.length;
      while (i < l) {
        resources += parseFloat(records[i].value);
        i++;
      }
      me.$set('resources', resources);
      me.set('toLoad', me.get('toLoad') - 1);
      if (me.get('toLoad') === 0) {
        return me.recalculate.call(me);
      }
    });
  };

  Balance.prototype.loadExpenses = function() {
    var db, expenses, from, me, q2, to;
    me = this;
    expenses = 0;
    from = new Date(app.logic.Date.parse(this.get('from')));
    to = new Date(app.logic.Date.parse(this.get('to')));
    db = app.data.db.getConnection();
    q2 = db.from('expenses');
    return q2.where('date', '>=', from.getTime(), '<', to.getTime() + 24 * 60 * 60 * 1000).list().done(function(records) {
      var i, l;
      i = 0;
      l = records.length;
      while (i < l) {
        expenses -= parseFloat(records[i].value);
        i++;
      }
      me.$set('expenses', expenses);
      me.set('toLoad', me.get('toLoad') - 1);
      if (me.get('toLoad') === 0) {
        return me.recalculate.call(me);
      }
    });
  };

  Balance.prototype.recalculate = function() {
    return this.$set('available', this.$get('resources') + this.$get('expenses'));
  };

  Balance.prototype.all = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  };

  Balance.prototype.getBalance = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  };

  app.models.balance = new Balance;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Balance.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Chart, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.models = app.models || {};

  yamvc = window.yamvc;

  Chart = yamvc.Model.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Model.apply(this, all);
    return this;
  });

  Chart.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return yamvc.Model.prototype.init.apply(this, all);
  };

  Chart.prototype.initConfig = function() {
    var all, config, initOpts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    initOpts = this.get('initOpts');
    initOpts.data = {
      type: 'AreaChart',
      title: 'Long term balance',
      isStacked: true,
      data: [['Day', 'Balance'], ['1', 0]]
    };
    config.namespace = 'balance';
    this.set('initOpts', initOpts);
    return yamvc.Model.prototype.initConfig.apply(this, all);
  };

  Chart.prototype.setRange = function(from, to) {
    this.set('from', from);
    return this.set('to', to);
  };

  Chart.prototype.load = function() {
    this.set('toLoad', 2);
    this.loadResources();
    this.loadExpenses();
    return this;
  };

  Chart.prototype.loadResources = function() {
    var db, incomes, me, q2;
    me = this;
    incomes = [];
    db = app.data.db.getConnection();
    q2 = db.from('incomes');
    return q2.list().done(function(records) {
      var i, l;
      i = 0;
      l = records.length;
      while (i < l) {
        incomes.push({
          date: records[i].date,
          value: parseFloat(records[i].value)
        });
        i++;
      }
      me.set('incomes', incomes);
      me.set('toLoad', me.get('toLoad') - 1);
      if (me.get('toLoad') === 0) {
        return me.recalculate.call(me);
      }
    });
  };

  Chart.prototype.loadExpenses = function() {
    var db, expenses, me, q2;
    me = this;
    expenses = [];
    db = app.data.db.getConnection();
    q2 = db.from('expenses');
    return q2.list().done(function(records) {
      var i, l;
      i = 0;
      l = records.length;
      while (i < l) {
        expenses.push({
          date: records[i].date,
          value: -parseFloat(records[i].value)
        });
        i++;
      }
      me.set('expenses', expenses);
      me.set('toLoad', me.get('toLoad') - 1);
      if (me.get('toLoad') === 0) {
        return me.recalculate.call(me);
      }
    });
  };

  Chart.prototype.recalculate = function() {
    var balance, chartsData, date, dateTime, i, l, now, operation, time;
    now = new Date();
    time = now.getTime();
    chartsData = [['Day', 'Balance']];
    balance = 0;
    operation = this.get('incomes');
    operation = operation.concat(this.get('expenses'));
    operation.sort(function(a, b) {
      return a.date - b.date;
    });
    i = 0;
    l = operation.length;
    while (i < l) {
      balance += operation[i].value;
      date = new Date(operation[i].date);
      dateTime = date.getTime();
      if ((dateTime + 31 * 24 * 60 * 60 * 1000) > time) {
        chartsData.push([date.getDate() + '/' + (date.getMonth() + 1), balance]);
      }
      i++;
    }
    return this.$set('data', chartsData);
  };

  Chart.prototype.all = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  };

  Chart.prototype.getChart = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
  };

  app.models.chart = new Chart;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Chart.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Expense, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.models = app.models || {};

  yamvc = window.yamvc;

  Expense = yamvc.Model.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Model.apply(this, all);
    return this;
  });

  Expense.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return yamvc.Model.prototype.init.apply(this, all);
  };

  Expense.prototype.initConfig = function() {
    var all, config, opts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    opts = this.get('initOpts');
    config.namespace = 'expenses';
    opts.data = opts.data || {};
    opts.data.date = opts.data.date || +(new Date);
    return yamvc.Model.prototype.initConfig.apply(this, all);
  };

  app.models.Expense = Expense;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Expense.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Income, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.models = app.models || {};

  yamvc = window.yamvc;

  Income = yamvc.Model.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.Model.apply(this, all);
    return this;
  });

  Income.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    return yamvc.Model.prototype.init.apply(this, all);
  };

  Income.prototype.initConfig = function() {
    var all, config, opts;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    opts = this.get('initOpts');
    config.namespace = 'incomes';
    opts.data = opts.data || {};
    opts.data.date = opts.data.date || +(new Date);
    return yamvc.Model.prototype.initConfig.apply(this, all);
  };

  app.models.Income = Income;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Income.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Bar, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Bar = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Bar.prototype.init = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.prototype.init.apply(this, all);
    config = this.get('config');
    return config.views = {
      buttonExpense: new app.views.Button({
        config: {
          tpl: 'tpl-button',
          renderTo: '.add-expense',
          models: {
            locale: new yamvc.Model({
              config: {
                namespace: 'locale'
              },
              data: {
                text: 'Add Expense'
              }
            })
          }
        }
      }),
      buttonIncome: new app.views.Button({
        config: {
          tpl: 'tpl-button',
          renderTo: '.add-income',
          models: {
            locale: new yamvc.Model({
              config: {
                namespace: 'locale'
              },
              data: {
                text: 'Add Income'
              }
            })
          }
        }
      })
    };
  };

  app.views.Bar = Bar;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Bar.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Balance, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Balance = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Balance.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.prototype.init.apply(this, all);
    this.bindEvents();
    return this;
  };

  Balance.prototype.bindEvents = function() {
    this.addListener('render', this.bindElements.bind(this));
    this.addListener('render', this.ajustBarsWidth.bind(this));
    this.getModel('balance').addListener('dataExpensesChange', this.updateBalance.bind(this));
    this.getModel('balance').addListener('dataResourcesChange', this.updateBalance.bind(this));
    this.getModel('balance').addListener('dataAvailableChange', this.updateBalance.bind(this));
    this.getModel('balance').addListener('dataChange', this.updateBalance.bind(this));
    return this;
  };

  Balance.prototype.bindElements = function() {
    this.set('$resources', this.queryEl('.bar-balance-resources'));
    this.set('$expenses', this.queryEl('.bar-balance-expenses'));
    return this;
  };

  Balance.prototype.updateBalance = function() {
    this.recalculateModel();
    this.partialRender('.bar-balance-resources');
    this.partialRender('.bar-balance-expenses');
    this.partialRender('.bar-balance-current');
    this.ajustBarsWidth();
    return this;
  };

  Balance.prototype.ajustBarsWidth = function() {
    var expenses, expensesLeft, expensesWidth, resources, resourcesLeft, resourcesWidth;
    expenses = Math.abs(this.getModel('balance').$get('expenses'));
    resources = this.getModel('balance').$get('resources');
    if (expenses === 0 && resources === 0) {
      expensesWidth = 0;
      resourcesWidth = 100;
      expensesLeft = 0;
      resourcesLeft = 0;
    } else if (expenses >= resources) {
      expensesWidth = 100;
      resourcesWidth = 0;
      expensesLeft = 0;
      resourcesLeft = 0;
    } else {
      expensesWidth = expenses === 0 ? 0 : parseInt(expenses / (resources / 100));
      resourcesWidth = 100 - expensesWidth;
      expensesLeft = 0;
      resourcesLeft = expensesWidth;
    }
    this.get('$resources').style.width = resourcesWidth + "%";
    this.get('$resources').style.left = resourcesLeft + "%";
    this.get('$expenses').style.width = expensesWidth + "%";
    this.get('$expenses').style.left = expensesLeft + "%";
    return this;
  };

  Balance.prototype.recalculateModel = function() {};

  app.views.BarBalance = Balance;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Balance.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Button, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Button = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  app.views.Button = Button;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Button.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Chart, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Chart = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Chart.prototype.init = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.prototype.init.apply(this, all);
    return this.bindEvents();
  };

  Chart.prototype.initConfig = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    config.models = {
      chart: app.models.chart
    };
    yamvc.View.prototype.initConfig.apply(this, all);
    return this.bindModelEvents();
  };

  Chart.prototype.bindEvents = function() {
    return this.addListener('render', this.initChart.bind(this));
  };

  Chart.prototype.bindModelEvents = function() {
    return this.getModel('chart').addListener('dataDataChange', this.redrawChart.bind(this));
  };

  Chart.prototype.redrawChart = function() {
    console.log('redraw!');
    return this.get('chart').draw(google.visualization.arrayToDataTable(this.getModel('chart').$get('data')), {
      title: this.getModel('chart').$get('title'),
      width: this.queryEl('.chart-container').offsetWidth,
      height: this.queryEl('.chart-container').offsetHeight,
      vAxis: {
        title: this.getModel('chart').$get('titlevAxis')
      },
      hAxis: {
        title: this.getModel('chart').$get('titlehAxis')
      }
    });
  };

  Chart.prototype.initChart = function() {
    var chart;
    chart = new google.visualization[this.getModel('chart').$get('type')](this.queryEl('.chart-container'));
    chart.draw(google.visualization.arrayToDataTable(this.getModel('chart').$get('data')), {
      title: this.getModel('chart').$get('title'),
      width: this.queryEl('.chart-container').offsetWidth,
      height: this.queryEl('.chart-container').offsetHeight,
      vAxis: {
        title: this.getModel('chart').$get('titlevAxis')
      },
      hAxis: {
        title: this.getModel('chart').$get('titlehAxis')
      }
    });
    this.set('chart', chart);
    return this.getModel('chart').load();
  };

  app.views.Chart = Chart;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Chart.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Layout, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Layout = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Layout.prototype.init = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.prototype.init.apply(this, all);
    config = this.get('config');
    return config.views = {
      barBalance: new app.views.BarBalance({
        config: {
          id: 'current-balance',
          tpl: 'tpl-bar-balance',
          renderTo: '.balance-container',
          models: {
            locale: new yamvc.Model({
              config: {
                namespace: 'locale'
              },
              data: {
                legend: 'Legend',
                expenses: 'monthly expenses',
                resources: 'monthly resources',
                currentBalance: 'Current balance'
              }
            }),
            balance: app.models.balance
          }
        }
      }),
      barActions: new app.views.Bar({
        config: {
          id: 'action-bar',
          tpl: 'tpl-bar-action',
          renderTo: '.layout-action-bar'
        }
      }),
      menu: new app.views.Menu({
        config: {
          id: 'menu',
          tpl: 'tpl-menu',
          renderTo: '.menu'
        }
      }),
      chart: new app.views.Chart({
        config: {
          id: 'dailyChart',
          tpl: 'tpl-chart',
          renderTo: '.container'
        }
      })
    };
  };

  app.views.Layout = Layout;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Layout.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Mask, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Mask = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Mask.prototype.show = function() {
    var style;
    style = this.get('el').style;
    return style.display = 'table';
  };

  Mask.prototype.hide = function() {
    var style;
    style = this.get('el').style;
    return style.display = 'none';
  };

  app.views.Mask = Mask;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Mask.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Menu, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Menu = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    return this;
  });

  Menu.prototype.init = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.prototype.init.apply(this, all);
    config = this.get('config');
    return config.views = {
      buttonIncomes: new app.views.Button({
        config: {
          id: 'list-incomes',
          tpl: 'tpl-button',
          renderTo: '.menu-action',
          models: {
            locale: new yamvc.Model({
              config: {
                namespace: 'locale'
              },
              data: {
                text: 'List all incomes'
              }
            })
          }
        }
      }),
      buttonExpenses: new app.views.Button({
        config: {
          id: 'list-expenses',
          tpl: 'tpl-button',
          renderTo: '.menu-action',
          models: {
            locale: new yamvc.Model({
              config: {
                namespace: 'locale'
              },
              data: {
                text: 'List all expenses'
              }
            })
          }
        }
      })
    };
  };

  app.views.Menu = Menu;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Menu.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var Window, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  yamvc = window.yamvc;

  Window = yamvc.View.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    yamvc.View.apply(this, all);
    this.bindEvents();
    return this;
  });

  Window.prototype.bindEvents = function() {
    this.addListener('render', this.resize.bind(this));
    this.addListener('render', this.bindClose.bind(this));
    return this.addListener('render', this.bindDOMEvents.bind(this));
  };

  Window.prototype.initConfig = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    config.width = config.width || 400;
    config.height = config.height || 300;
    config.views = config.views || {};
    config.views.close = new app.views.Button({
      config: {
        tpl: 'tpl-button',
        renderTo: '.top-bar',
        models: {
          locale: new yamvc.Model({
            config: {
              namespace: 'locale'
            },
            data: {
              text: 'X'
            }
          })
        }
      }
    });
    config = this.get('config');
    config.height = 200;
    config.views = config.views || {};
    config.views.add = new app.views.Button({
      config: {
        tpl: 'tpl-button',
        renderTo: '.bottom-bar',
        models: {
          locale: new yamvc.Model({
            config: {
              namespace: 'locale'
            },
            data: {
              text: 'Add'
            }
          })
        }
      }
    });
    return yamvc.View.prototype.initConfig.apply(this, all);
  };

  Window.prototype.bindClose = function() {
    var me;
    me = this;
    return this.queryEl('a').addEventListener('click', function(e) {
      e.preventDefault();
      me.hide();
      return this;
    }, true);
  };

  Window.prototype.bindDOMEvents = function() {
    this.queryEl('#form-name').addEventListener('keyup', this.validateName.bind(this));
    this.queryEl('#form-date').addEventListener('keyup', this.validateDate.bind(this));
    this.queryEl('#form-value').addEventListener('keyup', this.validateValue.bind(this));
    return this.queryEl('.bottom-bar a').addEventListener('click', this.processForm.bind(this), false);
  };

  Window.prototype.processForm = function() {};

  Window.prototype.validateName = function() {
    var value;
    value = this.queryEl('#form-name').value;
    if (value && value.length > 3) {
      return this.queryEl('#form-name').setAttribute('class', '');
    } else {
      return this.queryEl('#form-name').setAttribute('class', 'invalid');
    }
  };

  Window.prototype.validateDate = function() {
    var value;
    value = this.queryEl('#form-date').value;
    if (app.logic.Date.parse(value)) {
      return this.queryEl('#form-date').setAttribute('class', '');
    } else {
      return this.queryEl('#form-date').setAttribute('class', 'invalid');
    }
  };

  Window.prototype.validateValue = function() {
    var test, value;
    value = this.queryEl('#form-value').value;
    test = /^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/;
    if (test.test(value)) {
      return this.queryEl('#form-value').setAttribute('class', '');
    } else {
      return this.queryEl('#form-value').setAttribute('class', 'invalid');
    }
  };

  Window.prototype.resize = function() {
    var style;
    style = this.queryEl('.window-vertical-center').style;
    style.width = this.getWidth() + 'px';
    return style.height = this.getHeight() + 'px';
  };

  Window.prototype.show = function() {
    var style;
    style = this.get('el').style;
    return style.display = 'table';
  };

  Window.prototype.hide = function() {
    var style;
    style = this.get('el').style;
    return style.display = 'none';
  };

  app.views.Window = Window;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=Window.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var AddExpense, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  app.views.window = app.views.window || {};

  yamvc = window.yamvc;

  AddExpense = app.views.Window.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    app.views.Window.apply(this, all);
    return this;
  });

  AddExpense.prototype.initConfig = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    config.models = {
      locale: new yamvc.Model({
        config: {
          namespace: 'locale'
        },
        data: {
          name: 'Name',
          date: 'Date',
          value: 'Value',
          exName: 'e.g Book',
          exDate: 'e.g 23/9/2013',
          exValue: 'e.g 25.50'
        }
      }),
      expense: new app.models.Expense({
        config: {
          namespace: 'expenses',
          proxy: new app.data.proxy.YdnDb({
            config: {
              db: app.data.db
            }
          })
        }
      })
    };
    app.views.Window.prototype.initConfig.apply(this, all);
    return this.bindModelEvents();
  };

  AddExpense.prototype.bindEvents = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    app.views.Window.prototype.bindEvents.apply(this, all);
    return this.addListener('render', this.addClass.bind(this));
  };

  AddExpense.prototype.bindModelEvents = function() {
    return this.getModel('expense').addListener('saved', this.afterModelSave.bind(this));
  };

  AddExpense.prototype.processForm = function() {
    var i, inputs, l, results, test;
    test = [];
    inputs = this.queryEls('form input');
    this.validateName();
    this.validateDate();
    this.validateValue();
    results = {};
    i = 0;
    l = inputs.length;
    while (i < l) {
      if (inputs[i].getAttribute('class').search(/invalid/) > -1) {
        test.push(1);
      }
      results[inputs[i].name] = inputs[i].value;
      i++;
    }
    if (test.length === 0) {
      results['date'] = +new Date(app.logic.Date.parse(results['date']));
      this.getModel('expense').setData(results);
      app.mask.show();
      this.getModel('expense').save();
    }
    return this;
  };

  AddExpense.prototype.afterModelSave = function() {
    this.queryEl('form').reset();
    app.mask.hide();
    app.models.balance.load();
    app.models.chart.load();
    return this.hide();
  };

  AddExpense.prototype.addClass = function() {
    var form;
    form = this.queryEl('form');
    form.setAttribute('class', 'add-expenses');
    return form.setAttribute('data-type', 'add-expenses');
  };

  app.views.window.AddExpense = AddExpense;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=AddExpense.map
*/

// Generated by CoffeeScript 1.6.3
(function() {
  var AddIncome, app, yamvc,
    __slice = [].slice;

  app = window.app || {};

  app.views = app.views || {};

  app.views.window = app.views.window || {};

  yamvc = window.yamvc;

  AddIncome = app.views.Window.extend(function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    app.views.Window.apply(this, all);
    return this;
  });

  AddIncome.prototype.initConfig = function() {
    var all, config;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    config = this.get('config');
    config.models = {
      locale: new yamvc.Model({
        config: {
          namespace: 'locale'
        },
        data: {
          name: 'Name',
          date: 'Date',
          value: 'Value',
          exName: 'e.g Salary',
          exDate: 'e.g 23/3/2013',
          exValue: 'e.g 2005.55'
        }
      }),
      income: new app.models.Income({
        config: {
          namespace: 'incomes',
          proxy: new app.data.proxy.YdnDb({
            config: {
              db: app.data.db
            }
          })
        }
      })
    };
    app.views.Window.prototype.initConfig.apply(this, all);
    return this.bindModelEvents();
  };

  AddIncome.prototype.bindEvents = function() {
    var all;
    all = 1 <= arguments.length ? __slice.call(arguments, 0) : [];
    app.views.Window.prototype.bindEvents.apply(this, all);
    return this.addListener('render', this.addClass.bind(this));
  };

  AddIncome.prototype.bindModelEvents = function() {
    return this.getModel('income').addListener('saved', this.afterModelSave.bind(this));
  };

  AddIncome.prototype.processForm = function() {
    var i, inputs, l, results, test;
    test = [];
    inputs = this.queryEls('form input');
    this.validateName();
    this.validateDate();
    this.validateValue();
    results = {};
    i = 0;
    l = inputs.length;
    while (i < l) {
      if (inputs[i].getAttribute('class').search(/invalid/) > -1) {
        test.push(1);
      }
      results[inputs[i].name] = inputs[i].value;
      i++;
    }
    if (test.length === 0) {
      results['date'] = +new Date(app.logic.Date.parse(results['date']));
      this.getModel('income').setData(results);
      app.mask.show();
      this.getModel('income').save();
    }
    return this;
  };

  AddIncome.prototype.afterModelSave = function() {
    this.queryEl('form').reset();
    app.mask.hide();
    app.models.balance.load();
    app.models.chart.load();
    return this.hide();
  };

  AddIncome.prototype.addClass = function() {
    var form;
    form = this.queryEl('form');
    form.setAttribute('class', 'add-income');
    return form.setAttribute('data-type', 'add-income');
  };

  app.views.window.AddIncome = AddIncome;

  window.app = app;

}).call(this);

/*
//@ sourceMappingURL=AddIncome.map
*/
