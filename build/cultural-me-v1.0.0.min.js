/*! cultural-me v1.0.0 - 2013-12-17 
 *  License:  */
(function(){var e,t,n,i=[].slice;t=window.app||{},t.data=t.data||{},n=window.yamvc,e=n.Core.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,e),this}),e.prototype.init=function(){var e,t,a;if(e=arguments.length>=1?i.call(arguments,0):[],n.Core.prototype.init.apply(this,e),a=e[0]||{},t=a.config||{},this.set("initOpts",a),this.set("config",t),this.initConfig(),!this.getName)throw Error("Database name should be set")},e.prototype.connect=function(){return this.get("connect")||this.set("connect",new ydn.db.Storage(this.getName(),this.getSchema())),this},e.prototype.close=function(){return this.getConnection().close(),this.set("connect",null),this},e.prototype.getConnection=function(){return this.get("connect")||this.connect(),this.get("connect")},e.prototype.clear=function(){return this.getConnection().clear()},t.data.Db=e,window.app=t}).call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.data=t.data||{},t.data.proxy=t.data.proxy||{},n=window.yamvc,e=n.Core.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,e),this}),e.prototype.init=function(){var e,t,n;return e=arguments.length>=1?i.call(arguments,0):[],n=e[0]||{},t=n.config||{},t.idProperty="id",this.set("initOpts",n),this.set("config",t),this.initConfig(),this},e.prototype.getStatus=function(){return this.get("status")},e.prototype.getResponse=function(){return this.get("response")},e.prototype.read=function(e,t,n){var i,a,o;return a=this.getIdProperty(),"object"==typeof t[a]&&console.log(a),i=this.set.bind(this),o=this.getDb().getConnection().get(e,t[a]),o.done(function(e){return i("status","success"),t[a]=e,i("response",t),n()}),o.fail(function(e){return i("status","error"),i("response",e),n()}),this},e.prototype.create=function(e,t,n){var i,a,o;return i=this.set.bind(this),a=this.getIdProperty(),o=this.getDb().getConnection().put({name:e,keyPath:a},t),o.done(function(e){return i("status","success"),t[a]=e,i("response",t),n()}),o.fail(function(e){return i("status","error"),i("response",e),n()}),this},e.prototype.update=function(e,t,n){var i,a;return i=this.set.bind(this),a=this.getDb().getConnection().put(e,t),a.done(function(){return i("status","success"),i("response",t),n()}),a.fail(function(e){return i("status","error"),i("response",e),n()}),this},e.prototype.destroy=function(e,t,n){var i,a,o;return a=this.getIdProperty(),"object"==typeof t[a]&&console.log(a),i=this.set.bind(this),o=this.getDb().getConnection().remove(e,t[a]),o.done(function(){return i("status","success"),i("response",{}),n()}),o.fail(function(e){return i("status","error"),i("response",e),n()}),this},t.data.proxy.YdnDb=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.logic=t.logic||{},n=window.yamvc,e=n.Core.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,e),this}),e.prototype.daysInMonth=function(e,t){return new Date(t,e,0).getDate()},e.prototype.daysAgo=function(e,t){return new Date(+new Date(e)-1e3*60*60*24*t)},e.prototype.parse=function(e){var t,n,i,a,o;return o=function(e){var t;return(null!=(t=2===(""+e).length)?t:{"":"0"})+e},n=e.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/),t=n?new Date(n[3],n[2]-1,n[1]):null,a=t&&e===[o(t.getDate()),o(t.getMonth()+1),t.getFullYear()].join("/"),i=t&&e===[t.getDate(),t.getMonth()+1,t.getFullYear()].join("/"),a||i?t:null},t.logic.Date=new e,window.app=t}.call(this),function(){var e,t;e=window.app||{},t=window.yamvc,e.init=function(){return e.data.db=new e.data.Db({config:{name:"culturalMe",schema:{stores:[{name:"incomes",keyPath:"id",autoIncrement:!0,indexes:[{keyPath:"date"}]},{name:"expenses",keyPath:"id",autoIncrement:!0,indexes:[{keyPath:"date"}]}]}}}),e.views.layout=new e.views.Layout({config:{id:"layout",tpl:"tpl-layout",renderTo:"#container"}}),e.views.layout2=new e.views.Layout2({config:{id:"layout-2",tpl:"tpl-layout-2",renderTo:"#container"}}),e.views.income=new e.views.form.AddIncome({config:{id:"add-income",tpl:"tpl-window",renderTo:"body"}}),e.views.income.render(),e.views.expense=new e.views.form.AddExpense({config:{id:"add-expense",tpl:"tpl-window",renderTo:"body"}}),e.views.expense.render(),e.controlles={main:new t.Controller({config:{name:"Main",views:{layout:e.views.layout,"layout-2":e.views.layout2},routes:{"":"home","show-expenses":"showExpenses","show-incomes":"showIncomes"},events:{$layout:{render:function(){return e.models.balance.load(),setTimeout(function(){return e.mask.hide()},500)},show:function(){return setTimeout(function(){return e.mask.hide()},500)}},"$layout-2":{render:function(){return console.log("test"),setTimeout(function(){return e.mask.hide()},500)},show:function(){return setTimeout(function(){return e.mask.hide()},500)}},".add-expense a":{click:function(e,t){return t.preventDefault(),this.onExpenseBtnClick()}},".add-income a":{click:function(e,t){return t.preventDefault(),this.onIncomeBtnClick()}},".layout-2-action-bar .button":{click:function(e,t){return t.preventDefault(),this.onBackBtnClick()}},'[yamvc-id="list-incomes"] a':{click:function(e,t){return t.preventDefault(),this.onListIncomesBtnClick()}},'[yamvc-id="list-expenses"] a':{click:function(e,t){return t.preventDefault(),this.onListExpensesBtnClick()}}}},onBackBtnClick:function(){return this.redirectTo("")},onExpenseBtnClick:function(){return t.ViewManager.get("add-expense").show()},onIncomeBtnClick:function(){return t.ViewManager.get("add-income").show()},onListIncomesBtnClick:function(){return e.mask.show(),this.redirectTo("show-incomes")},onListExpensesBtnClick:function(){return e.mask.show(),this.redirectTo("show-expenses")},home:function(){return e.views.layout2.hide(),e.views.layout.isInDOM()?e.views.layout.show():e.views.layout.render()},showExpenses:function(){return e.views.layout.hide(),e.views.layout2.isInDOM()?e.views.layout2.show():e.views.layout2.render(),e.views.layout2.getChild("incomes").hide(),e.views.layout2.getChild("expenses").show()},showIncomes:function(){return e.views.layout.hide(),e.views.layout2.isInDOM()?e.views.layout2.show():e.views.layout2.render(),e.views.layout2.getChild("incomes").show(),e.views.layout2.getChild("expenses").hide()}})},this},window.app=e,t.onReady(e.init)}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.models=t.models||{},n=window.yamvc,e=n.Model.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,e)},e.prototype.initConfig=function(){var e,t,a,o;return e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),o=this.get("initOpts"),o.data={resources:0,expenses:0,available:0},a=new Date,this.set("from","1/"+(a.getMonth()+1)+"/"+a.getFullYear()),this.set("to",a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear()),t.namespace="balance",this.set("initOpts",o),n.Model.prototype.initConfig.apply(this,e)},e.prototype.setRange=function(e,t){return this.set("from",e),this.set("to",t)},e.prototype.load=function(){return this.set("toLoad",2),this.loadResources(),this.loadExpenses(),this},e.prototype.loadResources=function(){var e,n,i,a,o,s;return i=this,o=0,n=new Date(t.logic.Date.parse(this.get("from"))),s=new Date(t.logic.Date.parse(this.get("to"))),e=t.data.db.getConnection(),a=e.from("incomes"),a.where("date",">=",n.getTime(),"<",s.getTime()+864e5).list().done(function(e){var t,n;for(t=0,n=e.length;n>t;)o+=parseFloat(e[t].value),t++;return i.$set("resources",o),i.set("toLoad",i.get("toLoad")-1),0===i.get("toLoad")?i.recalculate.call(i):void 0})},e.prototype.loadExpenses=function(){var e,n,i,a,o,s;return a=this,n=0,i=new Date(t.logic.Date.parse(this.get("from"))),s=new Date(t.logic.Date.parse(this.get("to"))),e=t.data.db.getConnection(),o=e.from("expenses"),o.where("date",">=",i.getTime(),"<",s.getTime()+864e5).list().done(function(e){var t,i;for(t=0,i=e.length;i>t;)n-=parseFloat(e[t].value),t++;return a.$set("expenses",n),a.set("toLoad",a.get("toLoad")-1),0===a.get("toLoad")?a.recalculate.call(a):void 0})},e.prototype.recalculate=function(){return this.$set("available",this.$get("resources")+this.$get("expenses"))},e.prototype.all=function(){var e;e=arguments.length>=1?i.call(arguments,0):[]},e.prototype.getBalance=function(){var e;e=arguments.length>=1?i.call(arguments,0):[]},t.models.balance=new e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.models=t.models||{},n=window.yamvc,e=n.Model.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,e)},e.prototype.initConfig=function(){var e,t,a;return e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),a=this.get("initOpts"),a.data={type:"AreaChart",title:"Long term balance",isStacked:!0,data:[["Day","Balance"],["1",0]]},t.namespace="balance",this.set("initOpts",a),n.Model.prototype.initConfig.apply(this,e)},e.prototype.setRange=function(e,t){return this.set("from",e),this.set("to",t)},e.prototype.load=function(){return this.set("toLoad",2),this.loadResources(),this.loadExpenses(),this},e.prototype.loadResources=function(){var e,n,i,a;return i=this,n=[],e=t.data.db.getConnection(),a=e.from("incomes"),a.list().done(function(e){var t,a;for(t=0,a=e.length;a>t;)n.push({date:e[t].date,value:parseFloat(e[t].value)}),t++;return i.set("incomes",n),i.set("toLoad",i.get("toLoad")-1),0===i.get("toLoad")?i.recalculate.call(i):void 0})},e.prototype.loadExpenses=function(){var e,n,i,a;return i=this,n=[],e=t.data.db.getConnection(),a=e.from("expenses"),a.list().done(function(e){var t,a;for(t=0,a=e.length;a>t;)n.push({date:e[t].date,value:-parseFloat(e[t].value)}),t++;return i.set("expenses",n),i.set("toLoad",i.get("toLoad")-1),0===i.get("toLoad")?i.recalculate.call(i):void 0})},e.prototype.recalculate=function(){var e,t,n,i,a,o,s,r,l;for(s=new Date,l=s.getTime(),t=[["Day","Balance"]],e=0,r=this.get("incomes"),r=r.concat(this.get("expenses")),r.sort(function(e,t){return e.date-t.date}),a=0,o=r.length;o>a;)e+=r[a].value,n=new Date(r[a].date),i=n.getTime(),i+26784e5>l&&t.push([n.getDate()+"/"+(n.getMonth()+1),e]),a++;return this.$set("data",t)},t.models.chart=new e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.models=t.models||{},n=window.yamvc,e=n.Model.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,e)},e.prototype.initConfig=function(){var e,t,a;return e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),a=this.get("initOpts"),t.namespace="expenses",a.data=a.data||{},a.data.date=a.data.date||+new Date,n.Model.prototype.initConfig.apply(this,e)},t.models.Expense=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.models=t.models||{},n=window.yamvc,e=n.Model.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,e)},e.prototype.initConfig=function(){var e,t,a;return e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),a=this.get("initOpts"),t.namespace="incomes",a.data=a.data||{},a.data.date=a.data.date||+new Date,n.Model.prototype.initConfig.apply(this,e)},t.models.Income=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.models=t.models||{},n=window.yamvc,e=n.Model.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,e)},e.prototype.initConfig=function(){var e,t,a;return e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),a=this.get("initOpts"),a.data={data:[]},n.Model.prototype.initConfig.apply(this,e)},e.prototype.setCondition=function(){var e;return e=[{property:"date",conditions:[{condition:">",value:(new Date).getTime()-2592e6},{condition:"<",value:(new Date).getTime()}]}],this.set("conditions",e)},e.prototype.setOrder=function(e,t){return this.set("order",{property:e,desc:t})},e.prototype.load=function(){var e,n,i;return n=this,this.setCondition(),this.setOrder("date",!0),e=t.data.db.getConnection(),i=e.from(this.getNamespace()),i=this.addCondition(i),i=this.addOrder(i),i.list().done(function(e){return n.$set("data",e)}),this},e.prototype.addCondition=function(e){return this.get("conditions").forEach(function(t){var n;return n=[t.property],t.conditions.forEach(function(e){return n.push(e.condition),n.push(e.value)}),e.where.apply(e,n)}),e},e.prototype.addOrder=function(e){var t;return t=this.get("order"),t.desc?e.order(t.property).reverse():e.order(t.property)},t.models.Table=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),a=this.get("config"),a.views={buttonExpense:new t.views.Button({config:{tpl:"tpl-button",renderTo:".add-expense",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add Expense"}})}}}),buttonIncome:new t.views.Button({config:{tpl:"tpl-button",renderTo:".add-income",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add Income"}})}}})}},t.views.Bar=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),this.bindEvents(),this},e.prototype.bindEvents=function(){return this.addListener("render",this.bindElements.bind(this)),this.addListener("render",this.ajustBarsWidth.bind(this)),this.getModel("balance").addListener("dataExpensesChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataResourcesChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataAvailableChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataChange",this.updateBalance.bind(this)),this},e.prototype.bindElements=function(){return this.set("$resources",this.queryEl(".bar-balance-resources")),this.set("$expenses",this.queryEl(".bar-balance-expenses")),this},e.prototype.updateBalance=function(){return this.recalculateModel(),this.partialRender(".bar-balance-resources"),this.partialRender(".bar-balance-expenses"),this.partialRender(".bar-balance-current"),this.ajustBarsWidth(),this},e.prototype.ajustBarsWidth=function(){var e,t,n,i,a,o;return e=Math.abs(this.getModel("balance").$get("expenses")),i=this.getModel("balance").$get("resources"),0===e&&0===i?(n=0,o=100,t=0,a=0):e>=i?(n=100,o=0,t=0,a=0):(n=0===e?0:parseInt(e/(i/100)),o=100-n,t=0,a=n),this.get("$resources").style.width=o+"%",this.get("$resources").style.left=a+"%",this.get("$expenses").style.width=n+"%",this.get("$expenses").style.left=t+"%",this},e.prototype.recalculateModel=function(){},t.views.BarBalance=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),t.views.Button=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),this.bindEvents()},e.prototype.initConfig=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={chart:t.models.chart},n.View.prototype.initConfig.apply(this,e),this.bindModelEvents()},e.prototype.bindEvents=function(){return this.addListener("render",this.initChart.bind(this))},e.prototype.bindModelEvents=function(){return this.getModel("chart").addListener("dataDataChange",this.redrawChart.bind(this))},e.prototype.redrawChart=function(){return this.get("chart").draw(google.visualization.arrayToDataTable(this.getModel("chart").$get("data")),{title:this.getModel("chart").$get("title"),width:this.queryEl(".chart-container").offsetWidth,height:this.queryEl(".chart-container").offsetHeight,vAxis:{title:this.getModel("chart").$get("titlevAxis")},hAxis:{title:this.getModel("chart").$get("titlehAxis")}})},e.prototype.initChart=function(){var e;return e=new(google.visualization[this.getModel("chart").$get("type")])(this.queryEl(".chart-container")),e.draw(google.visualization.arrayToDataTable(this.getModel("chart").$get("data")),{title:this.getModel("chart").$get("title"),width:this.queryEl(".chart-container").offsetWidth,height:this.queryEl(".chart-container").offsetHeight,vAxis:{title:this.getModel("chart").$get("titlevAxis")},hAxis:{title:this.getModel("chart").$get("titlehAxis")}}),this.set("chart",e),this.getModel("chart").load()},t.views.Chart=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this.bindEvents(),this}),e.prototype.bindEvents=function(){return this.addListener("render",this.resize.bind(this)),this.addListener("render",this.bindClose.bind(this)),this.addListener("render",this.bindDOMEvents.bind(this))},e.prototype.initConfig=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.width=a.width||400,a.height=a.height||300,a.views=a.views||{},a.views.close=new t.views.Button({config:{tpl:"tpl-button",renderTo:".top-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"X"}})}}}),a=this.get("config"),a.height=200,a.views=a.views||{},a.views.add=new t.views.Button({config:{tpl:"tpl-button",renderTo:".bottom-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add"}})}}}),n.View.prototype.initConfig.apply(this,e)},e.prototype.bindClose=function(){var e;return e=this,this.queryEl("a").addEventListener("click",function(t){return t.preventDefault(),e.hide(),this},!0)},e.prototype.bindDOMEvents=function(){return this.queryEl("#form-name").addEventListener("keyup",this.validateName.bind(this)),this.queryEl("#form-date").addEventListener("keyup",this.validateDate.bind(this)),this.queryEl("#form-value").addEventListener("keyup",this.validateValue.bind(this)),this.queryEl(".bottom-bar a").addEventListener("click",this.processForm.bind(this),!1)},e.prototype.processForm=function(){},e.prototype.validateName=function(){var e;return e=this.queryEl("#form-name").value,e&&e.length>3?this.queryEl("#form-name").setAttribute("class",""):this.queryEl("#form-name").setAttribute("class","invalid")},e.prototype.validateDate=function(){var e;return e=this.queryEl("#form-date").value,t.logic.Date.parse(e)?this.queryEl("#form-date").setAttribute("class",""):this.queryEl("#form-date").setAttribute("class","invalid")},e.prototype.validateValue=function(){var e,t;return t=this.queryEl("#form-value").value,e=/^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/,e.test(t)?this.queryEl("#form-value").setAttribute("class",""):this.queryEl("#form-value").setAttribute("class","invalid")},e.prototype.resize=function(){var e;return e=this.queryEl(".window-vertical-center").style,e.width=this.getWidth()+"px",e.height=this.getHeight()+"px"},e.prototype.show=function(){var e,t;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.show.apply(this,e),t=this.get("el").style,t.display="table"},t.views.Form=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},t.views.form=t.views.form||{},n=window.yamvc,e=t.views.Form.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],t.views.Form.apply(this,e),this}),e.prototype.initConfig=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={locale:new n.Model({config:{namespace:"locale"},data:{name:"Name",date:"Date",value:"Value",exName:"e.g Book",exDate:"e.g 23/9/2013",exValue:"e.g 25.50"}}),expense:new t.models.Expense({config:{namespace:"expenses",proxy:new t.data.proxy.YdnDb({config:{db:t.data.db}})}})},t.views.Form.prototype.initConfig.apply(this,e),this.bindModelEvents()},e.prototype.bindEvents=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],t.views.Form.prototype.bindEvents.apply(this,e),this.addListener("render",this.addClass.bind(this))},e.prototype.bindModelEvents=function(){return this.getModel("expense").addListener("saved",this.afterModelSave.bind(this))},e.prototype.processForm=function(e){var n,i,a,o,s;for(e.preventDefault(),s=[],i=this.queryEls("form input"),this.validateName(),this.validateDate(),this.validateValue(),o={},n=0,a=i.length;a>n;)i[n].getAttribute("class").search(/invalid/)>-1&&s.push(1),o[i[n].name]=i[n].value,n++;return 0===s.length&&(o.date=+new Date(t.logic.Date.parse(o.date)),this.getModel("expense").setData(o),t.mask.show(),this.getModel("expense").save()),this},e.prototype.afterModelSave=function(){return this.queryEl("form").reset(),t.mask.hide(),t.models.balance.load(),t.models.chart.load(),this.hide()},e.prototype.addClass=function(){var e;return e=this.queryEl("form"),e.setAttribute("class","add-expenses"),e.setAttribute("data-type","add-expenses")},t.views.form.AddExpense=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},t.views.form=t.views.form||{},n=window.yamvc,e=t.views.Form.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],t.views.Form.apply(this,e),this}),e.prototype.initConfig=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={locale:new n.Model({config:{namespace:"locale"},data:{name:"Name",date:"Date",value:"Value",exName:"e.g Salary",exDate:"e.g 23/3/2013",exValue:"e.g 2005.55"}}),income:new t.models.Income({config:{namespace:"incomes",proxy:new t.data.proxy.YdnDb({config:{db:t.data.db}})}})},t.views.Form.prototype.initConfig.apply(this,e),this.bindModelEvents()},e.prototype.bindEvents=function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],t.views.Form.prototype.bindEvents.apply(this,e),this.addListener("render",this.addClass.bind(this))},e.prototype.bindModelEvents=function(){return this.getModel("income").addListener("saved",this.afterModelSave.bind(this))},e.prototype.processForm=function(e){var n,i,a,o,s;for(e.preventDefault(),s=[],i=this.queryEls("form input"),this.validateName(),this.validateDate(),this.validateValue(),o={},n=0,a=i.length;a>n;)i[n].getAttribute("class").search(/invalid/)>-1&&s.push(1),o[i[n].name]=i[n].value,n++;return 0===s.length&&(o.date=+new Date(t.logic.Date.parse(o.date)),this.getModel("income").setData(o),t.mask.show(),this.getModel("income").save()),this},e.prototype.afterModelSave=function(){return this.queryEl("form").reset(),t.mask.hide(),t.models.balance.load(),t.models.chart.load(),this.hide()},e.prototype.addClass=function(){var e;return e=this.queryEl("form"),e.setAttribute("class","add-income"),e.setAttribute("data-type","add-income")},t.views.form.AddIncome=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),a=this.get("config"),a.views={barBalance:new t.views.BarBalance({config:{id:"current-balance",tpl:"tpl-bar-balance",renderTo:".balance-container",models:{locale:new n.Model({config:{namespace:"locale"},data:{legend:"Legend",expenses:"monthly expenses",resources:"monthly resources",currentBalance:"Current balance"}}),balance:t.models.balance}}}),barActions:new t.views.Bar({config:{id:"action-bar",tpl:"tpl-bar-action",renderTo:".layout-action-bar"}}),menu:new t.views.Menu({config:{id:"menu",tpl:"tpl-menu",renderTo:".menu"}}),chart:new t.views.Chart({config:{id:"dailyChart",tpl:"tpl-chart",renderTo:".container"}})}},t.views.Layout=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),a=this.get("config"),a.views={incomes:new t.views.Table({config:{id:"table-incomes",tpl:"tpl-table",renderTo:".container",models:{data:new t.models.Table({config:{namespace:"incomes"}})},headers:[{text:"Id",dataIndex:"id"},{text:"Name",dataIndex:"name"},{text:"Value",dataIndex:"value"},{text:"Date",dataIndex:"date",convert:function(e){var t,n,i,a;return t=new Date(e),n=t.getDate(),i=t.getMonth()+1,a=t.getFullYear(),n+"/"+i+"/"+a}}]}}),expenses:new t.views.Table({config:{id:"table-expenses",tpl:"tpl-table",renderTo:".container",models:{data:new t.models.Table({config:{namespace:"expenses"}})},headers:[{text:"Id",dataIndex:"id"},{text:"Name",dataIndex:"name"},{text:"Value",dataIndex:"value"},{text:"Date",dataIndex:"date",convert:function(e){var t,n,i,a;return t=new Date(e),n=t.getDate(),i=t.getMonth()+1,a=t.getFullYear(),n+"/"+i+"/"+a}}]}}),buttonBack:new t.views.Button({config:{tpl:"tpl-button",renderTo:".layout-2-action-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Back"}})}}})}},t.views.Layout2=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.show=function(){var e;return e=this.get("el").style,e.display="table"},e.prototype.hide=function(){var e;return e=this.get("el").style,e.display="none"},t.views.Mask=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e,a;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),a=this.get("config"),a.views={buttonIncomes:new t.views.Button({config:{id:"list-incomes",tpl:"tpl-button",renderTo:".menu-action",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"List all incomes"}})}}}),buttonExpenses:new t.views.Button({config:{id:"list-expenses",tpl:"tpl-button",renderTo:".menu-action",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"List all expenses"}})}}})}},t.views.Menu=e,window.app=t}.call(this),function(){var e,t,n,i=[].slice;t=window.app||{},t.views=t.views||{},n=window.yamvc,e=n.View.extend(function(){var e;return e=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,e),this}),e.prototype.init=function(){var e,t;return e=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,e),t=this.get("config"),this.bindEvents()},e.prototype.initConfig=function(){var e,t;if(e=arguments.length>=1?i.call(arguments,0):[],t=this.get("config"),!t.headers||t.headers&&1>t.headers.length)throw Error("At least one header should be set for table");return n.View.prototype.initConfig.apply(this,e),this.bindModelEvents()},e.prototype.bindEvents=function(){return this.addListener("render",this.initTable.bind(this))},e.prototype.bindModelEvents=function(){return this.getModel("data").addListener("dataDataChange",this.redrawTable.bind(this))},e.prototype.initTable=function(){return this.getModel("data").load(),this.generateHeaders()},e.prototype.generateHeaders=function(){var e,t,n,i,a,o,s;for(t=this.getModel("data").getNamespace(),n=this.queryEl("thead"),i=document.createElement("tr"),i.setAttribute("class",t+"-tr"),s=this.getHeaders(),a=0,o=s.length;o>a;a++)e=s[a],this.generateHeader(i,t,e);return n.appendChild(i)},e.prototype.generateHeader=function(e,t,n){var i;return i=document.createElement("td"),i.setAttribute("class",t+"-td"),i.innerHTML=n.text,e.appendChild(i)},e.prototype.generateRows=function(){var e,t,n,i,a,o,s,r;for(t=this.getModel("data").getNamespace(),e=this.getHeaders(),i=this.queryEl("tbody"),s=this.getModel("data").$get("data"),r=[],a=0,o=s.length;o>a;a++)n=s[a],r.push(this.generateRow(i,t,e,n));return r},e.prototype.generateRow=function(e,t,n,i){var a,o,s;s=document.createElement("tr"),s.setAttribute("class",t+"-tr");for(a in n)o=n[a],this.generateCell(s,t,o.convert?o.convert(i[o.dataIndex]):i[o.dataIndex]);return e.appendChild(s)},e.prototype.generateCell=function(e,t,n){var i;return i=document.createElement("td"),i.setAttribute("class",t+"-td"),i.innerHTML=n,e.appendChild(i)},e.prototype.redrawTable=function(){var e;return e=this.queryEl("tbody"),e.innerHTML="",this.generateRows()},t.views.Table=e,window.app=t}.call(this);
//@ sourceMappingURL=cultural-me-v1.0.0.min.js.map