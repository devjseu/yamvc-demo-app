/*! cultural-me v1.0.0 - 2013-12-18 
 *  License:  */
(function(){var t,e,n,i=[].slice;e=window.app||{},e.data=e.data||{},n=window.yamvc,t=n.Core.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,t),this}),t.prototype.init=function(){var t,e,a;if(t=arguments.length>=1?i.call(arguments,0):[],n.Core.prototype.init.apply(this,t),a=t[0]||{},e=a.config||{},this.set("initOpts",a),this.set("config",e),this.initConfig(),!this.getName)throw Error("Database name should be set")},t.prototype.connect=function(){return this.get("connect")||this.set("connect",new ydn.db.Storage(this.getName(),this.getSchema())),this},t.prototype.close=function(){return this.getConnection().close(),this.set("connect",null),this},t.prototype.getConnection=function(){return this.get("connect")||this.connect(),this.get("connect")},t.prototype.clear=function(){return this.getConnection().clear()},e.data.Db=t,window.app=e}).call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.data=e.data||{},e.data.proxy=e.data.proxy||{},n=window.yamvc,t=n.Core.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,t),this}),t.prototype.init=function(){var t,e,n;return t=arguments.length>=1?i.call(arguments,0):[],n=t[0]||{},e=n.config||{},e.idProperty="id",this.set("initOpts",n),this.set("config",e),this.initConfig(),this},t.prototype.getStatus=function(){return this.get("status")},t.prototype.getResponse=function(){return this.get("response")},t.prototype.read=function(){return this},t.prototype.create=function(){return this},t.prototype.update=function(){return this},t.prototype.destroy=function(){return this},e.data.proxy.YdnDb=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.data=e.data||{},e.data.proxy=e.data.proxy||{},n=window.yamvc,t=n.Core.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,t),this}),t.prototype.init=function(){var t,e,n;return t=arguments.length>=1?i.call(arguments,0):[],n=t[0]||{},e=n.config||{},e.idProperty="id",this.set("initOpts",n),this.set("config",e),this.initConfig(),this},t.prototype.getStatus=function(){return this.get("status")},t.prototype.getResponse=function(){return this.get("response")},t.prototype.read=function(t,e,n){var i,a,o;return a=this.getIdProperty(),"object"==typeof e[a]&&console.log(a),i=this.set.bind(this),o=this.getDb().getConnection().get(t,e[a]),o.done(function(t){return i("status","success"),e[a]=t,i("response",e),n()}),o.fail(function(t){return i("status","error"),i("response",t),n()}),this},t.prototype.create=function(t,e,n){var i,a,o;return i=this.set.bind(this),a=this.getIdProperty(),o=this.getDb().getConnection().put({name:t,keyPath:a},e),o.done(function(t){return i("status","success"),e[a]=t,i("response",e),n()}),o.fail(function(t){return console.log(t),i("status","error"),i("response",t),n()}),this},t.prototype.update=function(t,e,n){var i,a;return i=this.set.bind(this),a=this.getDb().getConnection().put(t,e),a.done(function(){return i("status","success"),i("response",e),n()}),a.fail(function(t){return i("status","error"),i("response",t),n()}),this},t.prototype.destroy=function(t,e,n){var i,a,o;return a=this.getIdProperty(),i=this.set.bind(this),o=this.getDb().getConnection().remove(t,e[a]),o.done(function(){return i("status","success"),i("response",{}),n()}),o.fail(function(t){return i("status","error"),i("response",t),n()}),this},e.data.proxy.YdnDb=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.logic=e.logic||{},n=window.yamvc,t=n.Core.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Core.apply(this,t),this}),t.prototype.daysInMonth=function(t,e){return new Date(e,t,0).getDate()},t.prototype.daysAgo=function(t,e){return new Date(+new Date(t)-1e3*60*60*24*e)},t.prototype.parse=function(t){var e,n,i,a,o;return o=function(t){var e;return(null!=(e=2===(""+t).length)?e:{"":"0"})+t},n=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/),e=n?new Date(n[3],n[2]-1,n[1]):null,a=e&&t===[o(e.getDate()),o(e.getMonth()+1),e.getFullYear()].join("/"),i=e&&t===[e.getDate(),e.getMonth()+1,e.getFullYear()].join("/"),a||i?e:null},e.logic.Date=new t,window.app=e}.call(this),function(){var t,e;t=window.app||{},e=window.yamvc,t.init=function(){return t.data.db=new t.data.Db({config:{name:"culturalMe",schema:{stores:[{name:"incomes",keyPath:"id",autoIncrement:!0,indexes:[{keyPath:"date"}]},{name:"expenses",keyPath:"id",autoIncrement:!0,indexes:[{keyPath:"date"}]}]}}}),t.views.layout=new t.views.Layout({config:{id:"layout",tpl:"tpl-layout",renderTo:"#container"}}),t.views.layout2=new t.views.Layout2({config:{id:"layout-2",tpl:"tpl-layout-2",renderTo:"#container"}}),t.views.income=new t.views.form.AddIncome({config:{id:"add-income",tpl:"tpl-window",renderTo:"body"}}),t.views.income.render(),t.views.expense=new t.views.form.AddExpense({config:{id:"add-expense",tpl:"tpl-window",renderTo:"body"}}),t.views.expense.render(),t.controlles={main:new e.Controller({config:{name:"Main",views:{layout:t.views.layout,"layout-2":t.views.layout2},routes:{"":"home","show-expenses":"showExpenses","show-incomes":"showIncomes"},events:{$layout:{render:function(){return t.models.balance.load(),setTimeout(function(){return t.mask.hide()},500)},show:function(){return setTimeout(function(){return t.mask.hide()},500)}},"$layout-2":{render:function(){return setTimeout(function(){return t.mask.hide()},500)},show:function(){return setTimeout(function(){return t.mask.hide()},500)}},".add-expense a":{click:function(t,e){return e.preventDefault(),this.onExpenseBtnClick()}},".add-income a":{click:function(t,e){return e.preventDefault(),this.onIncomeBtnClick()}},".layout-2-action-bar .button":{click:function(t,e){return e.preventDefault(),this.onBackBtnClick()}},'[yamvc-id="list-incomes"] a':{click:function(t,e){return e.preventDefault(),this.onListIncomesBtnClick()}},'[yamvc-id="list-expenses"] a':{click:function(t,e){return e.preventDefault(),this.onListExpensesBtnClick()}}}},onBackBtnClick:function(){return this.redirectTo("")},onExpenseBtnClick:function(){return e.ViewManager.get("add-expense").show()},onIncomeBtnClick:function(){return e.ViewManager.get("add-income").show()},onListIncomesBtnClick:function(){return t.mask.show(),this.redirectTo("show-incomes")},onListExpensesBtnClick:function(){return t.mask.show(),this.redirectTo("show-expenses")},home:function(){return t.views.layout2.hide(),t.views.layout.isInDOM()?t.views.layout.show():t.views.layout.render()},showExpenses:function(){return t.views.layout.hide(),t.views.layout2.isInDOM()?(t.views.layout2.show(),t.views.layout2.getChild("expenses").getModel("expenses").load()):t.views.layout2.render(),t.views.layout2.getChild("incomes").hide(),t.views.layout2.getChild("expenses").show()},showIncomes:function(){return t.views.layout.hide(),t.views.layout2.isInDOM()?(t.views.layout2.show(),t.views.layout2.getChild("incomes").getModel("incomes").load()):t.views.layout2.render(),t.views.layout2.getChild("incomes").show(),t.views.layout2.getChild("expenses").hide()}})},this},window.app=t,e.onReady(t.init)}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.models=e.models||{},n=window.yamvc,t=n.Model.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,t)},t.prototype.initConfig=function(){var t,e,a,o;return t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),o=this.get("initOpts"),o.data={resources:0,expenses:0,available:0},a=new Date,this.set("from","1/"+(a.getMonth()+1)+"/"+a.getFullYear()),this.set("to",a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear()),e.namespace="balance",this.set("initOpts",o),n.Model.prototype.initConfig.apply(this,t)},t.prototype.setRange=function(t,e){return this.set("from",t),this.set("to",e)},t.prototype.load=function(){return this.set("toLoad",2),this.loadResources(),this.loadExpenses(),this},t.prototype.loadResources=function(){var t,n,i,a,o;return n=this,a=0,o=new Date(e.logic.Date.parse(this.get("to"))),t=e.data.db.getConnection(),i=t.from("incomes"),i.where("date","<",o.getTime()+864e5).list().done(function(t){var e,i;for(e=0,i=t.length;i>e;)a+=parseFloat(t[e].value),e++;return n.$set("resources",a),n.set("toLoad",n.get("toLoad")-1),0===n.get("toLoad")?n.recalculate.call(n):void 0})},t.prototype.loadExpenses=function(){var t,n,i,a,o,s,r,l,d;return s=this,a=0,t=0,r=new Date,n=1e3*60*60*24*r.getDate(),o=new Date(e.logic.Date.parse(this.get("from"))),d=new Date(e.logic.Date.parse(this.get("to"))),i=e.data.db.getConnection(),l=i.from("expenses"),l.where("date","<",d.getTime()+864e5).list().done(function(e){var i,o,l;for(i=0,o=e.length;o>i;)l=parseFloat(e[i].value),a-=l,e[i].date+n>r.getTime()&&(t-=l),i++;return s.$set("expenses",a),s.$set("currentMonthExpenses",t),s.set("toLoad",s.get("toLoad")-1),0===s.get("toLoad")?s.recalculate.call(s):void 0})},t.prototype.recalculate=function(){return this.$set("available",this.$get("resources")+this.$get("expenses")),this.$set("currentMonthResources",this.$get("resources")+(this.$get("expenses")-this.$get("currentMonthExpenses")))},t.prototype.all=function(){var t;t=arguments.length>=1?i.call(arguments,0):[]},t.prototype.getBalance=function(){var t;t=arguments.length>=1?i.call(arguments,0):[]},e.models.balance=new t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.models=e.models||{},n=window.yamvc,t=n.Model.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,t)},t.prototype.initConfig=function(){var t,e,a;return t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),a=this.get("initOpts"),a.data={type:"AreaChart",title:"Long term balance",isStacked:!0,data:[["Day","Balance"],["1",0]]},e.namespace="balance",this.set("initOpts",a),n.Model.prototype.initConfig.apply(this,t)},t.prototype.setRange=function(t,e){return this.set("from",t),this.set("to",e)},t.prototype.load=function(){return this.set("toLoad",2),this.loadResources(),this.loadExpenses(),this},t.prototype.loadResources=function(){var t,n,i,a;return i=this,n=[],t=e.data.db.getConnection(),a=t.from("incomes"),a.list().done(function(t){var e,a;for(e=0,a=t.length;a>e;)n.push({date:t[e].date,value:parseFloat(t[e].value)}),e++;return i.set("incomes",n),i.set("toLoad",i.get("toLoad")-1),0===i.get("toLoad")?i.recalculate.call(i):void 0})},t.prototype.loadExpenses=function(){var t,n,i,a;return i=this,n=[],t=e.data.db.getConnection(),a=t.from("expenses"),a.list().done(function(t){var e,a;for(e=0,a=t.length;a>e;)n.push({date:t[e].date,value:-parseFloat(t[e].value)}),e++;return i.set("expenses",n),i.set("toLoad",i.get("toLoad")-1),0===i.get("toLoad")?i.recalculate.call(i):void 0})},t.prototype.recalculate=function(){var t,e,n,i,a,o,s,r,l;for(s=new Date,l=s.getTime(),e=[["Day","Balance"]],t=0,r=this.get("incomes"),r=r.concat(this.get("expenses")),r.sort(function(t,e){return t.date-e.date}),a=0,o=r.length;o>a;)t+=r[a].value,n=new Date(r[a].date),i=n.getTime(),i+26784e5>l&&e.push([n.getDate()+"/"+(n.getMonth()+1),t]),a++;return 1===e.length&&e.push([0,0]),this.$set("data",e)},e.models.chart=new t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.models=e.models||{},n=window.yamvc,t=n.Model.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,t)},t.prototype.initConfig=function(){var t,e,a;return t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),a=this.get("initOpts"),e.namespace="expenses",a.data=a.data||{},a.data.date=a.data.date||+new Date,n.Model.prototype.initConfig.apply(this,t)},e.models.Expense=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.models=e.models||{},n=window.yamvc,t=n.Model.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,t)},t.prototype.initConfig=function(){var t,e,a;return t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),a=this.get("initOpts"),e.namespace="incomes",a.data=a.data||{},a.data.date=a.data.date||+new Date,n.Model.prototype.initConfig.apply(this,t)},e.models.Income=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.models=e.models||{},n=window.yamvc,t=n.Model.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.Model.prototype.init.apply(this,t)},t.prototype.initConfig=function(){var t,e,a;return t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),a=this.get("initOpts"),a.data={data:[]},n.Model.prototype.initConfig.apply(this,t)},t.prototype.setCondition=function(){var t;return t=[{property:"date",conditions:[{condition:">",value:(new Date).getTime()-2592e6},{condition:"<",value:(new Date).getTime()}]}],this.set("conditions",t)},t.prototype.setOrder=function(t,e){return this.set("order",{property:t,desc:e})},t.prototype.load=function(){var t,n,i;return n=this,this.setCondition(),this.setOrder("date",!0),t=e.data.db.getConnection(),i=t.from(this.getNamespace()),i=this.addCondition(i),i=this.addOrder(i),i.list().done(function(t){return n.$set("data",t)}),this},t.prototype.addCondition=function(t){return this.get("conditions").forEach(function(e){var n;return n=[e.property],e.conditions.forEach(function(t){return n.push(t.condition),n.push(t.value)}),t.where.apply(t,n)}),t},t.prototype.addOrder=function(t){var e;return e=this.get("order"),e.desc?t.order(e.property).reverse():t.order(e.property)},e.models.Table=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),a=this.get("config"),a.views={buttonExpense:new e.views.Button({config:{tpl:"tpl-button",renderTo:".add-expense",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add Expense"}})}}}),buttonIncome:new e.views.Button({config:{tpl:"tpl-button",renderTo:".add-income",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add Income"}})}}})}},e.views.Bar=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),this.bindEvents(),this},t.prototype.bindEvents=function(){return this.addListener("render",this.bindElements.bind(this)),this.addListener("render",this.ajustBarsWidth.bind(this)),this.getModel("balance").addListener("dataCurrentMonthExpensesChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataCurrentMonthResourcesChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataAvailableChange",this.updateBalance.bind(this)),this.getModel("balance").addListener("dataChange",this.updateBalance.bind(this)),this},t.prototype.bindElements=function(){return this.set("$resources",this.queryEl(".bar-balance-resources")),this.set("$expenses",this.queryEl(".bar-balance-expenses")),this},t.prototype.updateBalance=function(){return this.recalculateModel(),this.partialRender(".bar-balance-resources"),this.partialRender(".bar-balance-expenses"),this.partialRender(".bar-balance-current"),this.ajustBarsWidth(),this},t.prototype.ajustBarsWidth=function(){var t,e,n,i,a,o;return t=Math.abs(this.getModel("balance").$get("currentMonthExpenses")),i=this.getModel("balance").$get("currentMonthResources"),0===t&&0===i?(n=0,o=100,e=0,a=0):t>=i?(n=100,o=0,e=0,a=0):(n=0===t?0:parseInt(t/(i/100)),o=100-n,e=0,a=n),this.get("$resources").style.width=o+"%",this.get("$resources").style.left=a+"%",this.get("$expenses").style.width=n+"%",this.get("$expenses").style.left=e+"%",this},t.prototype.recalculateModel=function(){},e.views.BarBalance=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),e.views.Button=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),this.bindEvents()},t.prototype.initConfig=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={chart:e.models.chart},n.View.prototype.initConfig.apply(this,t),this.bindModelEvents()},t.prototype.bindEvents=function(){return this.addListener("render",this.initChart.bind(this))},t.prototype.bindModelEvents=function(){return this.getModel("chart").addListener("dataDataChange",this.redrawChart.bind(this))},t.prototype.redrawChart=function(){return this.get("chart").draw(google.visualization.arrayToDataTable(this.getModel("chart").$get("data")),{title:this.getModel("chart").$get("title"),width:this.queryEl(".chart-container").offsetWidth,height:this.queryEl(".chart-container").offsetHeight,vAxis:{title:this.getModel("chart").$get("titlevAxis")},hAxis:{title:this.getModel("chart").$get("titlehAxis")}})},t.prototype.initChart=function(){var t;return t=new(google.visualization[this.getModel("chart").$get("type")])(this.queryEl(".chart-container")),t.draw(google.visualization.arrayToDataTable(this.getModel("chart").$get("data")),{title:this.getModel("chart").$get("title"),width:this.queryEl(".chart-container").offsetWidth,height:this.queryEl(".chart-container").offsetHeight,vAxis:{title:this.getModel("chart").$get("titlevAxis")},hAxis:{title:this.getModel("chart").$get("titlehAxis")}}),this.set("chart",t),this.getModel("chart").load()},e.views.Chart=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this.bindEvents(),this}),t.prototype.bindEvents=function(){return this.addListener("render",this.resize.bind(this)),this.addListener("render",this.bindClose.bind(this)),this.addListener("render",this.bindDOMEvents.bind(this))},t.prototype.initConfig=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.width=a.width||400,a.views=a.views||{},a.views.close=new e.views.Button({config:{tpl:"tpl-button",renderTo:".top-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"X"}})}}}),a=this.get("config"),a.height=200,a.views=a.views||{},a.views.add=new e.views.Button({config:{tpl:"tpl-button",renderTo:".bottom-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Add"}})}}}),n.View.prototype.initConfig.apply(this,t)},t.prototype.bindClose=function(){var t;return t=this,this.queryEl("a").addEventListener("click",function(e){return e.preventDefault(),t.hide(),this},!0)},t.prototype.bindDOMEvents=function(){return this.queryEl("#form-name").addEventListener("keyup",this.validateName.bind(this)),this.queryEl("#form-date").addEventListener("keyup",this.validateDate.bind(this)),this.queryEl("#form-value").addEventListener("keyup",this.validateValue.bind(this)),this.queryEl(".bottom-bar a").addEventListener("click",this.processForm.bind(this),!1)},t.prototype.processForm=function(){},t.prototype.validateName=function(){var t;return t=this.queryEl("#form-name").value,t&&t.length>3?this.queryEl("#form-name").setAttribute("class",""):this.queryEl("#form-name").setAttribute("class","invalid")},t.prototype.validateDate=function(){var t;return t=this.queryEl("#form-date").value,e.logic.Date.parse(t)?this.queryEl("#form-date").setAttribute("class",""):this.queryEl("#form-date").setAttribute("class","invalid")},t.prototype.validateValue=function(){var t,e;return e=this.queryEl("#form-value").value,t=/^\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*$/,t.test(e)?this.queryEl("#form-value").setAttribute("class",""):this.queryEl("#form-value").setAttribute("class","invalid")},t.prototype.resize=function(){var t;return t=this.queryEl(".window").style,t.width=this.getWidth()+"px"},t.prototype.show=function(){var t,e;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.show.apply(this,t),e=this.get("el").style,e.display="table"},e.views.Form=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},e.views.form=e.views.form||{},n=window.yamvc,t=e.views.Form.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],e.views.Form.apply(this,t),this}),t.prototype.initConfig=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={locale:new n.Model({config:{namespace:"locale"},data:{name:"Name",date:"Date",value:"Value",exName:"e.g Book",exDate:"e.g 23/9/2013",exValue:"e.g 25.50"}}),expense:new e.models.Expense({config:{namespace:"expenses",proxy:new e.data.proxy.YdnDb({config:{db:e.data.db}})}})},e.views.Form.prototype.initConfig.apply(this,t),this.bindModelEvents()},t.prototype.bindEvents=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],e.views.Form.prototype.bindEvents.apply(this,t),this.addListener("render",this.addClass.bind(this))},t.prototype.bindModelEvents=function(){return this.getModel("expense").addListener("saved",this.afterModelSave.bind(this))},t.prototype.processForm=function(t){var n,i,a,o,s;for(t.preventDefault(),s=[],i=this.queryEls("form input"),this.validateName(),this.validateDate(),this.validateValue(),o={},n=0,a=i.length;a>n;)i[n].getAttribute("class").search(/invalid/)>-1&&s.push(1),o[i[n].name]=i[n].value,n++;return 0===s.length&&(o.date=+new Date(e.logic.Date.parse(o.date)),this.getModel("expense").clear(),this.getModel("expense").setData(o),e.mask.show(),this.getModel("expense").save()),this},t.prototype.afterModelSave=function(){return this.queryEl("form").reset(),e.mask.hide(),e.models.balance.load(),e.models.chart.load(),this.hide()},t.prototype.addClass=function(){var t;return t=this.queryEl("form"),t.setAttribute("class","add-expenses"),t.setAttribute("data-type","add-expenses")},e.views.form.AddExpense=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},e.views.form=e.views.form||{},n=window.yamvc,t=e.views.Form.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],e.views.Form.apply(this,t),this}),t.prototype.initConfig=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],a=this.get("config"),a.models={locale:new n.Model({config:{namespace:"locale"},data:{name:"Name",date:"Date",value:"Value",exName:"e.g Salary",exDate:"e.g 23/3/2013",exValue:"e.g 2005.55"}}),income:new e.models.Income({config:{namespace:"incomes",proxy:new e.data.proxy.YdnDb({config:{db:e.data.db}})}})},e.views.Form.prototype.initConfig.apply(this,t),this.bindModelEvents()},t.prototype.bindEvents=function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],e.views.Form.prototype.bindEvents.apply(this,t),this.addListener("render",this.addClass.bind(this))},t.prototype.bindModelEvents=function(){return this.getModel("income").addListener("saved",this.afterModelSave.bind(this))},t.prototype.processForm=function(t){var n,i,a,o,s;for(t.preventDefault(),s=[],i=this.queryEls("form input"),this.validateName(),this.validateDate(),this.validateValue(),o={},n=0,a=i.length;a>n;)i[n].getAttribute("class").search(/invalid/)>-1&&s.push(1),o[i[n].name]=i[n].value,n++;return 0===s.length&&(o.date=+new Date(e.logic.Date.parse(o.date)),this.getModel("income").clear(),this.getModel("income").setData(o),e.mask.show(),this.getModel("income").save()),this},t.prototype.afterModelSave=function(){return this.queryEl("form").reset(),e.mask.hide(),e.models.balance.load(),e.models.chart.load(),this.hide()},t.prototype.addClass=function(){var t;return t=this.queryEl("form"),t.setAttribute("class","add-income"),t.setAttribute("data-type","add-income")},e.views.form.AddIncome=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),a=this.get("config"),a.views={barBalance:new e.views.BarBalance({config:{id:"current-balance",tpl:"tpl-bar-balance",renderTo:".balance-container",models:{locale:new n.Model({config:{namespace:"locale"},data:{legend:"Legend",expenses:"monthly expenses",resources:"available resources",currentBalance:"Current month balance"}}),balance:e.models.balance}}}),barActions:new e.views.Bar({config:{id:"action-bar",tpl:"tpl-bar-action",renderTo:".layout-action-bar"}}),menu:new e.views.Menu({config:{id:"menu",tpl:"tpl-menu",renderTo:".menu"}}),chart:new e.views.Chart({config:{id:"dailyChart",tpl:"tpl-chart",renderTo:".container"}})}},e.views.Layout=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),a=this.get("config"),a.views={incomes:new e.views.Table({config:{id:"table-incomes",tpl:"tpl-table",renderTo:".container",models:{data:new e.models.Table({config:{namespace:"incomes"}})},headers:[{text:"Id",dataIndex:"id"},{text:"Name",dataIndex:"name"},{text:"Value",dataIndex:"value"},{text:"Date",dataIndex:"date",convert:function(t){var e,n,i,a;return e=new Date(t),n=e.getDate(),i=e.getMonth()+1,a=e.getFullYear(),n+"/"+i+"/"+a}}]}}),expenses:new e.views.Table({config:{id:"table-expenses",tpl:"tpl-table",renderTo:".container",models:{data:new e.models.Table({config:{namespace:"expenses"}})},headers:[{text:"Id",dataIndex:"id"},{text:"Name",dataIndex:"name"},{text:"Value",dataIndex:"value"},{text:"Date",dataIndex:"date",convert:function(t){var e,n,i,a;return e=new Date(t),n=e.getDate(),i=e.getMonth()+1,a=e.getFullYear(),n+"/"+i+"/"+a}}]}}),buttonBack:new e.views.Button({config:{tpl:"tpl-button",renderTo:".layout-2-action-bar",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"Back"}})}}})}},e.views.Layout2=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.show=function(){var t;return t=this.get("el").style,t.display="table"},t.prototype.hide=function(){var t;return t=this.get("el").style,t.display="none"},e.views.Mask=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t,a;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),a=this.get("config"),a.views={buttonIncomes:new e.views.Button({config:{id:"list-incomes",tpl:"tpl-button",renderTo:".menu-action",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"List all incomes"}})}}}),buttonExpenses:new e.views.Button({config:{id:"list-expenses",tpl:"tpl-button",renderTo:".menu-action",models:{locale:new n.Model({config:{namespace:"locale"},data:{text:"List all expenses"}})}}})}},e.views.Menu=t,window.app=e}.call(this),function(){var t,e,n,i=[].slice;e=window.app||{},e.views=e.views||{},n=window.yamvc,t=n.View.extend(function(){var t;return t=arguments.length>=1?i.call(arguments,0):[],n.View.apply(this,t),this}),t.prototype.init=function(){var t,e;return t=arguments.length>=1?i.call(arguments,0):[],n.View.prototype.init.apply(this,t),e=this.get("config"),this.bindEvents()},t.prototype.initConfig=function(){var t,e;if(t=arguments.length>=1?i.call(arguments,0):[],e=this.get("config"),!e.headers||e.headers&&1>e.headers.length)throw Error("At least one header should be set for table");return n.View.prototype.initConfig.apply(this,t),this.bindModelEvents()},t.prototype.bindEvents=function(){return this.addListener("render",this.initTable.bind(this))},t.prototype.bindModelEvents=function(){return this.getModel("data").addListener("dataDataChange",this.redrawTable.bind(this))},t.prototype.initTable=function(){return this.getModel("data").load(),this.generateHeaders()},t.prototype.generateHeaders=function(){var t,e,n,i,a,o,s;for(e=this.getModel("data").getNamespace(),n=this.queryEl("thead"),i=document.createElement("tr"),i.setAttribute("class",e+"-tr"),s=this.getHeaders(),a=0,o=s.length;o>a;a++)t=s[a],this.generateHeader(i,e,t);return n.appendChild(i)},t.prototype.generateHeader=function(t,e,n){var i;return i=document.createElement("td"),i.setAttribute("class",e+"-td"),i.innerHTML=n.text,t.appendChild(i)},t.prototype.generateRows=function(){var t,e,n,i,a,o,s,r;for(e=this.getModel("data").getNamespace(),t=this.getHeaders(),i=this.queryEl("tbody"),s=this.getModel("data").$get("data"),r=[],a=0,o=s.length;o>a;a++)n=s[a],r.push(this.generateRow(i,e,t,n));return r},t.prototype.generateRow=function(t,e,n,i){var a,o,s;s=document.createElement("tr"),s.setAttribute("class",e+"-tr");for(a in n)o=n[a],this.generateCell(s,e,o.convert?o.convert(i[o.dataIndex]):i[o.dataIndex]);return t.appendChild(s)},t.prototype.generateCell=function(t,e,n){var i;return i=document.createElement("td"),i.setAttribute("class",e+"-td"),i.innerHTML=n,t.appendChild(i)},t.prototype.redrawTable=function(){var t;return t=this.queryEl("tbody"),t.innerHTML="",this.generateRows()},e.views.Table=t,window.app=e}.call(this);
//@ sourceMappingURL=cultural-me-v1.0.0.min.js.map